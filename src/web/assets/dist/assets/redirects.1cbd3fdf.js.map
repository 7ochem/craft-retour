{"version":3,"file":"redirects.1cbd3fdf.js","sources":["../../../../../buildchain/src/vue/RedirectsFieldDefs.js","../../../../../buildchain/src/vue/LegacyUrl.vue?vue&type=template&lang.js","../../../../../buildchain/src/vue/LegacyUrl.vue","../../../../../buildchain/src/vue/RedirectsTable.vue?vue&type=template&lang.js","../../../../../buildchain/src/vue/RedirectsTable.vue","../../../../../buildchain/src/js/Redirects.js"],"sourcesContent":["// Field definitions for RedirectsTable.vue\nexport default [\n    {\n        name: '__checkbox',\n        titleClass: 'center aligned',\n        dataClass: 'center aligned'\n    },\n    {\n        name: '__component:legacy-url',\n        sortField: 'redirectSrcUrl',\n        title: 'Legacy URL Pattern',\n        titleClass: 'center',\n        dataClass: 'center',\n    },\n    {\n        name: 'redirectDestUrl',\n        sortField: 'redirectDestUrl',\n        title: 'Redirect To',\n        titleClass: 'center',\n        dataClass: 'center',\n        callback: 'urlFormatter'\n    },\n    {\n        name: 'redirectMatchType',\n        sortField: 'redirectMatchType',\n        title: 'Match Type',\n        titleClass: 'text-left',\n        dataClass: 'text-left',\n        callback: 'matchFormatter'\n    },\n    {\n        name: 'siteName',\n        sortField: 'siteId',\n        title: 'Sites',\n        titleClass: 'text-left',\n        dataClass: 'text-left',\n    },\n    {\n        name: 'redirectHttpCode',\n        sortField: 'redirectHttpCode',\n        title: 'Status',\n        titleClass: 'text-left',\n        dataClass: 'text-left',\n    },\n    {\n        name: 'hitCount',\n        sortField: 'hitCount',\n        title: 'Hits',\n        titleClass: 'text-right',\n        dataClass: 'text-right',\n    },\n    {\n        name: 'hitLastTime',\n        sortField: 'hitLastTime',\n        title: 'Last Hit',\n        titleClass: 'center',\n        dataClass: 'center',\n    },\n];\n","\n<div>\n  <a\n    :href=\"rowData.editLink\"\n    class=\"go\"\n    :title=\"linkTitle\"\n  ><span style=\"white-space: nowrap;\"><span\n    class=\"status\"\n    :class=\"redirectEnabled\"\n  /><span style=\"white-space: normal;\">{{ rowData.redirectSrcUrl }}</span></span></a>\n</div>\n","<template>\n  <div>\n    <a\n      :href=\"rowData.editLink\"\n      class=\"go\"\n      :title=\"linkTitle\"\n    ><span style=\"white-space: nowrap;\"><span\n      class=\"status\"\n      :class=\"redirectEnabled\"\n    /><span style=\"white-space: normal;\">{{ rowData.redirectSrcUrl }}</span></span></a>\n  </div>\n</template>\n\n<script>\n    export default {\n        props: {\n            rowData: {\n                type: Object,\n                required: true\n            },\n            rowIndex: {\n                type: Number,\n                default: 0\n            }\n        },\n        computed: {\n            linkTitle: function() {\n                let title = '';\n\n                title += this.rowData.redirectSrcUrl;\n\n                return title;\n            },\n            redirectEnabled: function() {\n                let enabled = '';\n\n                if (+this.rowData.enabled) {\n                    return 'live';\n                }\n\n                return enabled;\n            }\n        }\n    }\n</script>\n","\n<div>\n  <div\n    v-show=\"numSelected !== 0\"\n    class=\"\"\n  >\n    <form\n      method=\"post\"\n      accept-charset=\"UTF-8\"\n    >\n      <input\n        type=\"hidden\"\n        :name=\"csrfTokenName\"\n        :value=\"csrfTokenValue\"\n      >\n      <input\n        v-for=\"selectedId in selectedIds\"\n        :key=\"selectedId\"\n        type=\"hidden\"\n        name=\"redirectIds[]\"\n        :value=\"selectedId\"\n      >\n      <label class=\"text-gray-600\">{{ numSelected }} redirect<span v-if=\"numSelected !== 1\">s</span>:</label>\n      <div class=\"btngroup inline\">\n        <div\n          class=\"btn menubtn\"\n          data-icon=\"settings\"\n        />\n        <div\n          class=\"menu\"\n          data-align=\"right\"\n        >\n          <ul>\n            <li>\n              <a\n                class=\"formsubmit\"\n                data-action=\"retour/redirects/delete-redirects\"\n              >Delete</a>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </form>\n  </div>\n  <vuetable-filter-bar\n    v-show=\"numSelected === 0\"\n    :initial-filter-text=\"filterText\"\n  />\n  <div class=\"vuetable-pagination clearafter\">\n    <vuetable-pagination-info ref=\"paginationInfoTop\" />\n\n    <div class=\"floated left vuetable-pagination-info py-3\">\n      <div class=\"inline pl-3 text-gray-600\">\n        Per-page:\n      </div>\n      <div class=\"inline pl-3 text-gray-600\">\n        <div class=\"select\">\n          <select\n            v-model=\"perPage\"\n            class=\"fieldtoggle\"\n            data-target-prefix=\"per-page-\"\n            name=\"perPage\"\n          >\n            <option\n              value=\"20\"\n              selected\n            >\n              20\n            </option>\n            <option value=\"50\">\n              50\n            </option>\n            <option value=\"100\">\n              100\n            </option>\n            <option value=\"500\">\n              500\n            </option>\n          </select>\n        </div>\n      </div>\n    </div>\n\n    <vuetable-pagination\n      ref=\"paginationTop\"\n      @vuetable-pagination:change-page=\"onChangePage\"\n    />\n  </div>\n  <vuetable\n    ref=\"vuetable\"\n    :api-url=\"apiUrl\"\n    :per-page=\"perPage\"\n    :fields=\"fields\"\n    :css=\"css\"\n    :sort-order=\"sortOrder\"\n    :append-params=\"moreParams\"\n    @vuetable:pagination-data=\"onPaginationData\"\n  />\n  <div class=\"vuetable-pagination clearafter border-solid\">\n    <vuetable-pagination-info ref=\"paginationInfo\" />\n    <vuetable-pagination\n      ref=\"pagination\"\n      @vuetable-pagination:change-page=\"onChangePage\"\n    />\n  </div>\n</div>\n","<template>\n  <div>\n    <div\n      v-show=\"numSelected !== 0\"\n      class=\"\"\n    >\n      <form\n        method=\"post\"\n        accept-charset=\"UTF-8\"\n      >\n        <input\n          type=\"hidden\"\n          :name=\"csrfTokenName\"\n          :value=\"csrfTokenValue\"\n        >\n        <input\n          v-for=\"selectedId in selectedIds\"\n          :key=\"selectedId\"\n          type=\"hidden\"\n          name=\"redirectIds[]\"\n          :value=\"selectedId\"\n        >\n        <label class=\"text-gray-600\">{{ numSelected }} redirect<span v-if=\"numSelected !== 1\">s</span>:</label>\n        <div class=\"btngroup inline\">\n          <div\n            class=\"btn menubtn\"\n            data-icon=\"settings\"\n          />\n          <div\n            class=\"menu\"\n            data-align=\"right\"\n          >\n            <ul>\n              <li>\n                <a\n                  class=\"formsubmit\"\n                  data-action=\"retour/redirects/delete-redirects\"\n                >Delete</a>\n              </li>\n            </ul>\n          </div>\n        </div>\n      </form>\n    </div>\n    <vuetable-filter-bar\n      v-show=\"numSelected === 0\"\n      :initial-filter-text=\"filterText\"\n    />\n    <div class=\"vuetable-pagination clearafter\">\n      <vuetable-pagination-info ref=\"paginationInfoTop\" />\n\n      <div class=\"floated left vuetable-pagination-info py-3\">\n        <div class=\"inline pl-3 text-gray-600\">\n          Per-page:\n        </div>\n        <div class=\"inline pl-3 text-gray-600\">\n          <div class=\"select\">\n            <select\n              v-model=\"perPage\"\n              class=\"fieldtoggle\"\n              data-target-prefix=\"per-page-\"\n              name=\"perPage\"\n            >\n              <option\n                value=\"20\"\n                selected\n              >\n                20\n              </option>\n              <option value=\"50\">\n                50\n              </option>\n              <option value=\"100\">\n                100\n              </option>\n              <option value=\"500\">\n                500\n              </option>\n            </select>\n          </div>\n        </div>\n      </div>\n\n      <vuetable-pagination\n        ref=\"paginationTop\"\n        @vuetable-pagination:change-page=\"onChangePage\"\n      />\n    </div>\n    <vuetable\n      ref=\"vuetable\"\n      :api-url=\"apiUrl\"\n      :per-page=\"perPage\"\n      :fields=\"fields\"\n      :css=\"css\"\n      :sort-order=\"sortOrder\"\n      :append-params=\"moreParams\"\n      @vuetable:pagination-data=\"onPaginationData\"\n    />\n    <div class=\"vuetable-pagination clearafter border-solid\">\n      <vuetable-pagination-info ref=\"paginationInfo\" />\n      <vuetable-pagination\n        ref=\"pagination\"\n        @vuetable-pagination:change-page=\"onChangePage\"\n      />\n    </div>\n  </div>\n</template>\n\n<script>\nimport FieldDefs from '@/vue/RedirectsFieldDefs.js';\nimport LegacyUrl from '@/vue/LegacyUrl.vue';\nimport VueTable from 'vuetable-2/src/components/Vuetable.vue';\nimport VueTablePagination from '@/vue/VuetablePagination.vue';\nimport VueTablePaginationInfo from '@/vue/VuetablePaginationInfo.vue';\nimport VueTableFilterBar from '@/vue/VuetableFilterBar.vue';\nimport saveState from 'vue-save-state';\nimport DOMPurify from 'dompurify';\n\nVue.component('LegacyUrl', LegacyUrl);\n// Our component exports\nexport default {\n  components: {\n    'vuetable': VueTable,\n    'vuetable-pagination': VueTablePagination,\n    'vuetable-pagination-info': VueTablePaginationInfo,\n    'vuetable-filter-bar': VueTableFilterBar,\n  },\n  mixins: [saveState],\n  props: {\n    siteId: {\n      type: Number,\n      default: 0,\n    },\n    apiUrl: {\n      type: String,\n      default: '',\n    },\n  },\n  data: function () {\n    return {\n      moreParams: {\n        'siteId': this.siteId,\n      },\n      css: {\n        tableClass: 'data fullwidth retour-redirects',\n        ascendingIcon: 'menubtn retour-menubtn-asc',\n        descendingIcon: 'menubtn retour-menubtn-desc'\n      },\n      sortOrder: [\n        {\n          field: 'hitCount',\n          sortField: 'hitCount',\n          direction: 'desc'\n        }\n      ],\n      fields: FieldDefs,\n      numSelected: 0,\n      selectedIds: [],\n      filterText: '',\n      perPage: 20,\n   }\n  },\n  computed: {\n    csrfTokenName: function () {\n      return window.Craft.csrfTokenName;\n    },\n    csrfTokenValue: function () {\n      return window.Craft.csrfTokenValue;\n    },\n  },\n  watch: {\n    perPage: function () {\n      this.$events.fire('refresh-table', this.$refs.vuetable);\n    }\n  },\n  mounted() {\n    this.$events.$on('filter-set', eventData => this.onFilterSet(eventData));\n    this.$events.$on('filter-reset', () => this.onFilterReset());\n    this.$refs.vuetable.$on('vuetable:checkbox-toggled', (isChecked, dataItem) => this.onCheckboxToggled(isChecked, dataItem));\n    this.$refs.vuetable.$on('vuetable:checkbox-toggled-all', (isChecked) => this.onCheckboxToggled(isChecked, null));\n  },\n  methods: {\n    getSaveStateConfig() {\n      const cacheKey = 'retour-redirects-state-' + Craft.username + Craft.siteId;\n      return {\n        'cacheKey': cacheKey,\n        'ignoreProperties': ['numSelected', 'selectedIds'],\n      };\n    },\n    onFilterSet(filterText) {\n      this.filterText = filterText;\n      this.moreParams = {\n        'filter': this.filterText,\n        'siteId': this.siteId,\n      };\n      this.$events.fire('refresh-table', this.$refs.vuetable);\n    },\n    onFilterReset() {\n      this.filterText = '';\n      this.moreParams = {\n        'filter': this.filterText,\n        'siteId': this.siteId,\n      };\n      this.$events.fire('refresh-table', this.$refs.vuetable);\n    },\n    onPaginationData(paginationData) {\n      this.$refs.paginationTop.setPaginationData(paginationData);\n      this.$refs.paginationInfoTop.setPaginationData(paginationData);\n\n      this.$refs.pagination.setPaginationData(paginationData);\n      this.$refs.paginationInfo.setPaginationData(paginationData);\n    },\n    onChangePage(page) {\n      this.$refs.vuetable.changePage(page);\n    },\n    onCheckboxToggled() {\n      this.numSelected = 0;\n      this.selectedIds = [];\n      if (this.$refs.vuetable !== undefined && this.$refs.vuetable.selectedTo !== undefined) {\n        this.numSelected = this.$refs.vuetable.selectedTo.length;\n        this.selectedIds = this.$refs.vuetable.selectedTo;\n      }\n    },\n    matchFormatter(value) {\n      let label = 'Pluing Match';\n      switch (value) {\n        case 'exactmatch':\n          label = 'Exact Match';\n          break;\n        case 'regexmatch':\n          label = 'RegEx Match';\n          break;\n      }\n\n      return label;\n    },\n    urlFormatter(value) {\n      if (value === '') {\n        return '';\n      }\n      value = DOMPurify.sanitize(value);\n      let url = value;\n      let absoluteUrl = new RegExp('^(?:[a-z]+:)?//', 'i');\n      if (!absoluteUrl.test(url) && !url.includes('$')) {\n        url = Craft.getSiteUrl(Craft.trim(value, '/'));\n      }\n      return `\n                <a class=\"go\" href=\"${url}\" title=\"${url}\" target=\"_blank\" rel=\"noopener\">${value}</a>\n                `;\n    },\n    deleteRedirectFormatter(value) {\n      if (value === '') {\n        return '';\n      }\n      return `\n                <a class=\"delete icon\" href=\"${value}\" title=\"Delete\"></a>\n                `;\n    }\n  }\n}\n</script>\n","import Vue from 'vue';\nimport VueEvents from 'vue-events';\nimport RedirectsTable from '@/vue/RedirectsTable.vue';\n\nVue.use(VueEvents);\n// Create our vue instance\nnew Vue({\n    el: \"#cp-nav-content\",\n    components: {\n        'redirects-table': RedirectsTable,\n    },\n    mounted() {\n        this.$events.$on('refresh-table', eventData => this.onTableRefresh(eventData));\n    },\n    methods: {\n        onTableRefresh (vuetable) {\n            Vue.nextTick( () => vuetable.refresh());\n        }\n    },\n});\n"],"names":["render","staticRenderFns","Vue","VueEvents"],"mappings":"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"}